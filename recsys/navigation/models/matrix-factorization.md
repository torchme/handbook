# Matrix factorization

## –û—Ç–±–æ—Ä –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤: –º–∞—Ç—Ä–∏—á–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

–ú–∞—Ç—Ä–∏—á–Ω–∞—è —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ—Å—Ç–∞–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º. –ò –Ω–∞–ø—Ä–∏–º–µ—Ä –∑–∞ —Ç–æ –≤—Ä–µ–º—è –ø–æ–∫–∞ —è —Ä–∞–±–æ—Ç–∞—é –≤ —Ä–∏—Ç–µ–π–ª–µ –º–∞—Ç—Ä–∏—á–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å–∏–ª—å–Ω–æ –≤—ã–∏–≥—Ä–∞—é—Ç —É –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å—Ñ–µ—Ä–∞—Ö –±–∏–∑–Ω–µ—Å–∞ –∑–∞ –∏—Ö –ø—Ä–æ—Å—Ç–æ—Ç—É, —Å–∫–æ—Ä–æ—Å—Ç—å –∏ –±–µ–∑ –∏–∑–ª–∏—à–µ—Å—Ç–≤.&#x20;

–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —è –±—ã —Ö–æ—Ç–µ–ª –ø–æ–¥—Ä–æ–±–Ω–æ —Å–∏–ª—å–Ω–æ —É–≥–ª—É–±–∏—Ç—å—Å—è –≤ –º–∞—Ç—Ä–∏—á–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–∏–≥–Ω–∞–ª, —Ç–∏–ø—ã —Ñ–∏—Ç–±–µ–∫–∞ –∏ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –ø–æ—á–µ–º—É –∂–µ ALS –≤—Å–µ –µ—â–µ —Ç–∞–∫ —Ö–æ—Ä–æ—à.

***

## RecSys 101

–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–π –º–∞–≥–∞–∑–∏–Ω –≥–¥–µ –µ—Å—Ç—å 5\_000\_000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, 100\_000 —Ç–æ–≤–∞—Ä–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–∫—É–ø–∞—é—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ.&#x20;

–ú—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å –º–∞—Ç—Ä–∏—Ü—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π ùëÖ —Ä–∞–∑–º–µ—Ä–æ–º ùëö √ó ùëõ, –≥–¥–µ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç $$r_{ij}$$‚Äã –æ—Ç—Ä–∞–∂–∞–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ùëñ —Å —ç–ª–µ–º–µ–Ω—Ç–æ–º ùëó.&#x20;

–≠—Ç–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–æ–∂–µ—Ç –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è <mark style="color:blue;">**feedback**</mark> –∏ –æ–Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å:

* –î–ª—è —Ç–æ–≤–∞—Ä–∞, —á—Ç–æ –µ–≥–æ –ø–æ–ª–æ–∂–∏–ª–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É
* –î–ª—è –º—É–∑—ã–∫–∏, —á—Ç–æ –µ–µ –¥–æ—Å–ª—É—à–∞–ª–∏
* –î–ª—è —Å—Ç–∞—Ç—å–∏, —á—Ç–æ –µ–µ –ª–∞–π–∫–Ω—É–ª–∏
* –î–ª—è –≤–∏–¥–µ–æ, —á—Ç–æ –µ–≥–æ –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –±–æ–ª—å—à–µ —á–µ–º –Ω–∞ –ø–æ–ª–æ–≤–∏–Ω—É
* etc

### Explicit feedback

**explicit feedback** - —ç—Ç–æ —Ç–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã—Ä–∞–∂–∞—é—Ç —è–≤–Ω–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ —Ç–æ–≤–∞—Ä—É.&#x20;

<figure><img src="../../../.gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
–ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ —Ç–∞–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –º–∞–ª–æ, –Ω–æ –æ–Ω–∏ –Ω–∞–º–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–µ–µ&#x20;
{% endhint %}

–¢–∞–∫-–∂–µ –¥–∏–∑–ª–∞–π–∫–∏ –º–æ–≥—É—Ç –Ω–µ –æ–∑–Ω–∞—á–∞—Ç—å, —á—Ç–æ –µ–º—É –Ω–µ –ø–æ–¥–æ–±–Ω—ã–π —Ç–æ–≤–∞—Ä –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞, –≤–æ–∑–º–æ–∂–Ω–æ –µ–º—É –Ω–µ –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä –∏–ª–∏ —É –Ω–µ–≥–æ –Ω–µ–ø—Ä–∏—è–∑–Ω—å –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –∞–≤—Ç–æ—Ä—É, —Ñ–∏–ª—å–º—É.&#x20;

### Implicit feedback

**implicit feedback** - —ç—Ç–æ –ª—é–±–∞—è –¥—Ä—É–≥–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–∞–π—Ç–µ. –û–Ω –Ω–µ –æ—Ç—Ä–∞–∂–∞–µ—Ç —è–≤–Ω–æ–≥–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ —Ç–æ–≤–∞—Ä—É, –Ω–æ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–∫—Å–∏-–º–µ—Ç—Ä–∏–∫–æ–π.

<figure><img src="../../../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
–¢–∞–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–Ω–æ–≥–æ, –Ω–æ –æ–Ω–∏ –æ—á–µ–Ω—å —à—É–º–Ω—ã–µ
{% endhint %}

–ü–æ–∫—É–ø–∫–∏ —Ç–æ–∂–µ –Ω–µ –æ–∑–Ω–∞—á–∞—é—Ç —è–≤–Ω–æ–≥–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–Ω—É–∂–¥–µ–Ω –ø–æ–∫—É–ø–∞—Ç—å –¥–∞–Ω–Ω—ã–π —Ç–æ–≤–∞—Ä, —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–¥–∞—Ä–æ–∫ –∏–ª–∏ —Ä–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π.&#x20;

### –ö–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ

–¢–µ–ø–µ—Ä—å –∫–æ–≥–¥–∞ –º—ã —á—É—Ç—å –±–æ–ª—å—à–µ –∑–Ω–∞–µ–º –æ –¥–∞–Ω–Ω—ã—Ö, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–Ω–æ –æ–±—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º—Å—è, –∫–∞–∫ –∂–µ –Ω–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ –±—ã –º—ã –º–æ–≥–ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å <mark style="color:blue;">**—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ**</mark> —Ç–æ–≤–∞—Ä—ã?

<figure><img src="../../../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

–î–ª—è –ø—Ä–∏–º–µ—Ä–∞ –≤–æ–∑—å–º–µ–º 4 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ 10 —Ç–æ–≤–∞—Ä–æ–≤ —Å –Ω–∞—à–µ–≥–æ —Ä–∏—Ç–µ–π–ª –º–∞–≥–∞–∑–∏–Ω–∞.&#x20;

* –ö–∞—Ç–µ –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è <mark style="color:green;">**1, 4, 8**</mark> –∏ –Ω–µ –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è <mark style="color:red;">**5**</mark> —Ç–æ–≤–∞—Ä
* –ü–µ—Ç–µ  –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è <mark style="color:green;">**1,**</mark>** **<mark style="color:orange;">**3,**</mark>** **<mark style="color:green;">**8,**</mark> –Ω–æ –Ω–µ –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è <mark style="color:red;">**4 –∏ 5**</mark> —Ç–æ–≤–∞—Ä

–≠—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂–∏ –ø–æ —Å–≤–æ–µ–π –∏—Å—Ç–æ—Ä–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π, —Ç–∞–∫ –ø–æ—á–µ–º—É –±—ã –Ω–∞–º –Ω–µ –ø–æ—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å <mark style="color:orange;">**3**</mark> —Ç–æ–≤–∞—Ä –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ –ü–µ—Ç–∏?&#x20;

{% hint style="info" %}
–ò–¥–µ—è **–∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏** - —Ö–æ—Ç–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ç–æ–≤–∞—Ä—ã –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è –ø–æ—Ö–æ–∂–∏–º –Ω–∞ –Ω–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.&#x20;

–ê –≤ –±–æ–ª–µ–µ –æ–±—â–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ —Å–µ–º–µ–π—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –ø–æ—Ö–æ–∂–µ—Å—Ç—è—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ç–æ–≤–∞—Ä–∞–º–∏.&#x20;
{% endhint %}

### User2User

–ú–µ—Ç–æ–¥ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Ö–æ–∂–µ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ–π –∏–∑ –ø—Ä–æ—Å—Ç–µ–π—à–∏—Ö –∏ –Ω–∞–∏–±–æ–ª–µ–µ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏. –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ–±—ã —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ç–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–∏—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å –ø–æ—Ö–æ–∂–∏–º–∏ –≤–∫—É—Å–∞–º–∏.

–¢–∞–∫–æ–π –ø—Ä–∏–º–µ—Ä –º—ã —É–∂–µ —Ä–∞–∑–æ–±—Ä–∞–ª–∏, –Ω–æ –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –ø–æ–ø–æ–¥—Ä–æ–±–Ω–µ–µ –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

#### –®–∞–≥ 1: –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –º–µ—Ä—É —Å—Ö–æ–∂–µ—Å—Ç–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

–î–ª—è —ç—Ç–æ–≥–æ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –æ–¥–Ω–æ–π –∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –º–µ—Ä —Å—Ö–æ–∂–µ—Å—Ç–∏ ‚Äî –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ü–∏—Ä—Å–æ–Ω–∞. –ú—ã –±—É–¥–µ–º —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ –ø–æ—Ö–æ–∂–∏ —Ä–µ–π—Ç–∏–Ω–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ —Å–æ—Å–µ–¥–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

#### –§–æ—Ä–º—É–ª–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ü–∏—Ä—Å–æ–Ω–∞ –¥–ª—è –¥–≤—É—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π u –∏ v:

$$
s(u, v) = \frac{\sum_{i \in I_{u} \cap I_{v}} (r_{ui} - \bar{r}_{u})(r_{vi} - \bar{r}_{v})}{\sqrt{\sum_{i \in I_{u} \cap I_{v}} (r_{ui} - \bar{r}_{u})^2} \sqrt{\sum_{i \in I_{u} \cap I_{v}} (r_{vi} - \bar{r}_{v})^2}}
$$

–ì–¥–µ:

* $$r_{ui}$$ –∏ $$r_{vi}$$ ‚Äî —Ä–µ–π—Ç–∏–Ω–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π u –∏ v –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞ i,
* $$\bar{r}{u}$$ _–∏_ $$\bar{r}{v}$$ ‚Äî —Å—Ä–µ–¥–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π u –∏ v,
* $$I_u \cap I_v$$ ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ü–µ–Ω–∏–ª–∏ –æ–±–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

#### –®–∞–≥ 2: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å–µ–¥–µ–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–∞—Å—á–µ—Ç–Ω—ã–µ –º–µ—Ä—ã —Å—Ö–æ–∂–µ—Å—Ç–∏, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å —Å–æ—Å–µ–¥–µ–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è u. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã–±–µ—Ä–µ–º —Ç–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ö–æ–∂–µ—Å—Ç–∏ $$s(u, v)$$ –≤—ã—à–µ –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –ø–æ—Ä–æ–≥–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è $$\alpha$$.

#### –®–∞–≥ 3: –û—Ü–µ–Ω–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞ –¥–ª—è –Ω–µ–ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å —Å—Ö–æ–∂–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (—Å–æ—Å–µ–¥–∏), –º—ã –º–æ–∂–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (u) –Ω–µ –æ—Ü–µ–Ω–∏–≤–∞–ª, –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ —Å–æ—Å–µ–¥–µ–π:

$$
\hat{r}_{ui} = \frac{\sum_{v \in N(u)} s(u, v) r_{vi}}{\sum_{v \in N(u)} |s(u, v)|}
$$

–ì–¥–µ:

* $$\hat{r}_{ui}$$ ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞ i –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º u,
* $$r_{vi}$$ ‚Äî —Ä–µ–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ —ç–ª–µ–º–µ–Ω—Ç–∞ i —Å–æ—Å–µ–¥–æ–º v.

#### –®–∞–≥ 4: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤

–ü–æ—Å–ª–µ –æ—Ü–µ–Ω–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –¥–ª—è –≤—Å–µ—Ö –Ω–µ–ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –º–æ–∂–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é u —Ç–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—É—á–∏–ª–∏ –Ω–∞–∏–≤—ã—Å—à–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ —Ä–µ–π—Ç–∏–Ω–≥–∏.

```python
import numpy as np

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–µ—Ä—ã —Å—Ö–æ–∂–µ—Å—Ç–∏ –ü–∏—Ä—Å–æ–Ω–∞
def pearson_similarity(user_ratings, user1, user2):
    common_items = np.intersect1d(user_ratings.columns[user_ratings.loc[user1] != 0], 
                                  user_ratings.columns[user_ratings.loc[user2] != 0])
    
    if len(common_items) == 0:
        return 0
    
    r1 = user_ratings.loc[user1, common_items]
    r2 = user_ratings.loc[user2, common_items]
    
    mean_r1 = r1.mean()
    mean_r2 = r2.mean()
    
    numerator = np.sum((r1 - mean_r1) * (r2 - mean_r2))
    denominator = np.sqrt(np.sum((r1 - mean_r1) ** 2)) * np.sqrt(np.sum((r2 - mean_r2) ** 2))
    
    return numerator / denominator if denominator != 0 else 0

# –í—ã—á–∏—Å–ª–∏–º –º–µ—Ä—É —Å—Ö–æ–∂–µ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –∫ –¥—Ä—É–≥–∏–º
users = df.index
similarities = pd.DataFrame(np.zeros((len(users), len(users))), index=users, columns=users)

for user1 in users:
    for user2 in users:
        if user1 != user2:
            similarities.loc[user1, user2] = pearson_similarity(df, user1, user2)

# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã —Å—Ö–æ–∂–µ—Å—Ç–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
tools.display_dataframe_to_user(name="User Similarity Matrix", dataframe=similarities)

similarities


#          –ü–µ—Ç—è  –ú–∞—à–∞  –í–∞—Å—è     –ö–∞—Ç—è
# –ü–µ—Ç—è  0.00000   0.0   0.0  0.57735
# –ú–∞—à–∞  0.00000   0.0   0.0  0.00000
# –í–∞—Å—è  0.00000   0.0   0.0 -0.50000
# –ö–∞—Ç—è  0.57735   0.0  -0.5  0.00000
```

#### –ú–∞—Ç—Ä–∏—Ü–∞ —Å—Ö–æ–∂–µ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)

* –ö–∞—Ç—è –Ω–∞–∏–±–æ–ª–µ–µ —Å—Ö–æ–∂–∞ —Å –ü–µ—Ç–µ–π (—Å—Ö–æ–∂–µ—Å—Ç—å ( s(–ö–∞—Ç—è, –ü–µ—Ç—è) = 0.577 )).
* –£ –ö–∞—Ç–∏ –∏ –í–∞—Å–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å (( s(–ö–∞—Ç—è, –í–∞—Å—è) = -0.5 )), —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è—Ö.
* –ú–∞—à–∞ –∏ –í–∞—Å—è –Ω–µ –∏–º–µ—é—Ç –∑–Ω–∞—á–∏–º–æ–π —Å—Ö–æ–∂–µ—Å—Ç–∏ —Å –¥—Ä—É–≥–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.

#### –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ –¥–ª—è –ö–∞—Ç–∏

```python
# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ—Å–µ–¥–µ–π
def predict_rating(user_ratings, similarities, user, item):
    neighbors = similarities.loc[user].nlargest(2).index  # –≤—ã–±–∏—Ä–∞–µ–º –¥–≤—É—Ö —Å–∞–º—ã—Ö –ø–æ—Ö–æ–∂–∏—Ö —Å–æ—Å–µ–¥–µ–π
    
    numerator = 0
    denominator = 0
    
    for neighbor in neighbors:
        rating_by_neighbor = user_ratings.loc[neighbor, item]
        if rating_by_neighbor != 0:  # –ï—Å–ª–∏ —Å–æ—Å–µ–¥ –æ—Ü–µ–Ω–∏–ª —ç—Ç–æ—Ç —ç–ª–µ–º–µ–Ω—Ç
            similarity = similarities.loc[user, neighbor]
            numerator += similarity * rating_by_neighbor
            denominator += abs(similarity)
    
    return numerator / denominator if denominator != 0 else 0

# –ù–∞–π–¥–µ–º –¥–ª—è –ö–∞—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø–æ –≤—Å–µ–º –Ω–µ–ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–∞–º
unrated_items = df.columns[df.loc['–ö–∞—Ç—è'] == 0]
predicted_ratings = {}

for item in unrated_items:
    predicted_ratings[item] = predict_rating(df, similarities, '–ö–∞—Ç—è', item)

# –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ –¥–ª—è –ö–∞—Ç–∏
predicted_ratings

# {'Item 2': 0, 'Item 3': 1.0, 'Item 6': 0, 'Item 7': 0, 'Item 9': 0}
```

* **Item 3**: 1.0 (–≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ –ö–∞—Ç–µ –ø–æ–Ω—Ä–∞–≤–∏—Ç—Å—è —ç—Ç–æ—Ç —ç–ª–µ–º–µ–Ω—Ç)
* –û—Å—Ç–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ–ª—É—á–∏–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ 0.

#### –ò—Ç–æ–≥

–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ user-to-user —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –º–æ–∂–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –ö–∞—Ç–µ **Item 3**, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ—Ç —ç–ª–µ–º–µ–Ω—Ç –ø–æ–ª—É—á–∏–ª –Ω–∞–∏–≤—ã—Å—à–∏–π –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥.

### Item2Item

**Item-to-Item –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** ‚Äî —ç—Ç–æ –ø–æ–¥—Ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ö–æ–∂–µ—Å—Ç–∏ –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏, –∞ –Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.&#x20;

Item-to-Item ‚Äî —ç—Ç–æ –ø–æ–¥—Ö–æ–¥ –∫ –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–∏ —Å—Ö–æ–∂–µ—Å—Ç–∏ –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ (—Ç–æ–≤–∞—Ä–∞–º–∏) –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π, –≤–º–µ—Å—Ç–æ —Ä–∞—Å—á–µ—Ç–∞ —Å—Ö–æ–∂–µ—Å—Ç–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø–æ–ª—É—á–∏–ª —à–∏—Ä–æ–∫–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –±–ª–∞–≥–æ–¥–∞—Ä—è –µ–≥–æ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ [—Å–∏—Å—Ç–µ–º–∞—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π Amazon](https://www.cs.umd.edu/\~samir/498/Amazon-Recommendations.pdf).

–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –æ—Ü–µ–Ω–∏–ª, –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ—Ö–æ–∂–∏—Ö –Ω–∞ –Ω–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â—ë –Ω–µ –æ—Ü–µ–Ω–∏–≤–∞–ª. –¢–∞–∫–æ–π –º–µ—Ç–æ–¥ –±–æ–ª–µ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å User-to-User —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π, —Ç–∞–∫ –∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –º–µ–Ω—å—à–µ, —á–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —á—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∏ —É–ª—É—á—à–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å.

#### –ü–æ—á–µ–º—É Item2Item —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω?

* **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: User2User –ø–ª–æ—Ö–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º —á–∏—Å–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ Item2Item –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –º–µ–Ω—å—à–∏–º –Ω–∞–±–æ—Ä–æ–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
* **–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞**: –ë–ª–∞–≥–æ–¥–∞—Ä—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –º–æ–∂–Ω–æ –ª—É—á—à–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏ —É–ª—É—á—à–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

#### –®–∞–≥–∏:

1. –ü–æ—Å—Ç—Ä–æ–∏–º –º–∞—Ç—Ä–∏—Ü—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π (user-item).
2. –†–∞—Å—Å—á–∏—Ç–∞–µ–º —Å—Ö–æ–∂–µ—Å—Ç—å –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ (item-to-item).
3. –ü—Ä–µ–¥—Å–∫–∞–∂–µ–º —Ä–µ–π—Ç–∏–Ω–≥–∏ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â–µ –Ω–µ –æ—Ü–µ–Ω–∏–ª.
4. –í—ã–¥–∞–¥–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.

<pre class="language-python" data-overflow="wrap" data-full-width="true"><code class="lang-python">import pandas as pd
import numpy as np

# –®–∞–≥ 1: –°–æ–∑–¥–∞–µ–º –º–∞—Ç—Ä–∏—Ü—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π user-item
data = {
    'Item 1':  [1, 0, -1, 1],
    'Item 2':  [0, 1, 0, 0],
    'Item 3':  [1, 0, -1, 0],
    'Item 4':  [-1, -1, 0, 1],
    'Item 5':  [-1, 0, -1, -1],
    'Item 6':  [0, 0, 0, 0],
    'Item 7':  [0, 0, 1, 0],
    'Item 8':  [1, 0, 0, 1],
    'Item 9':  [0, 0, 0, 0],
    'Item 10': [0, 0, 1, -1]
}

df = pd.DataFrame(data, index=['–ü–µ—Ç—è', '–ú–∞—à–∞', '–í–∞—Å—è', '–ö–∞—Ç—è'])

# –®–∞–≥ 2: –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–µ—Ä—ã —Å—Ö–æ–∂–µ—Å—Ç–∏ –ü–∏—Ä—Å–æ–Ω–∞ –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
def pearson_similarity_items(user_ratings, item1, item2):
    common_users = np.intersect1d(user_ratings.index[user_ratings[item1] != 0], 
                                  user_ratings.index[user_ratings[item2] != 0])
    
    if len(common_users) == 0:
        return 0
    
    r1 = user_ratings.loc[common_users, item1]
    r2 = user_ratings.loc[common_users, item2]
    
    mean_r1 = r1.mean()
    mean_r2 = r2.mean()
    
    numerator = np.sum((r1 - mean_r1) * (r2 - mean_r2))
    denominator = np.sqrt(np.sum((r1 - mean_r1) ** 2)) * np.sqrt(np.sum((r2 - mean_r2) ** 2))
    
    return numerator / denominator if denominator != 0 else 0

# –®–∞–≥ 3: –í—ã—á–∏—Å–ª—è–µ–º –º–∞—Ç—Ä–∏—Ü—É —Å—Ö–æ–∂–µ—Å—Ç–∏ –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä —ç–ª–µ–º–µ–Ω—Ç–æ–≤
items = df.columns
item_similarities = pd.DataFrame(np.zeros((len(items), len(items))), index=items, columns=items)

for item1 in items:
    for item2 in items:
        if item1 != item2:
            item_similarities.loc[item1, item2] = pearson_similarity_items(df, item1, item2)

print("–ú–∞—Ç—Ä–∏—Ü–∞ —Å—Ö–æ–∂–µ—Å—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:")
print(item_similarities)

# –ú–∞—Ç—Ä–∏—Ü–∞ —Å—Ö–æ–∂–µ—Å—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:
#          Item 1  Item 2  Item 3  Item 4  Item 5  Item 6  Item 7  Item 8  Item 9  Item 10
# Item 1      0.0     0.0     1.0     0.0     0.0     0.0     0.0     0.0     0.0     -1.0
# Item 2      0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0      0.0
# Item 3      1.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0      0.0
# Item 4      0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0      0.0
# Item 5      0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0      0.0
# Item 6      0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0      0.0
# Item 7      0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0      0.0
# Item 8      0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0      0.0
# Item 9      0.0     0.0     


# –®–∞–≥ 4: –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ item-item –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
def predict_rating_item_based(user_ratings, item_similarities, user, item):
    rated_items = user_ratings.columns[user_ratings.loc[user] != 0]  # —ç–ª–µ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –æ—Ü–µ–Ω–∏–ª
    
    numerator = 0
    denominator = 0
    
    for rated_item in rated_items:
        rating_by_user = user_ratings.loc[user, rated_item]
        similarity = item_similarities.loc[item, rated_item]
        numerator += similarity * rating_by_user
        denominator += abs(similarity)
    
    return numerator / denominator if denominator != 0 else 0

# –®–∞–≥ 5: –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –ö–∞—Ç–∏)
user = '–ö–∞—Ç—è'
unrated_items = df.columns[df.loc[user] == 0]
predicted_ratings_item_based = {}

for item in unrated_items:
    predicted_ratings_item_based[item] = predict_rating_item_based(df, item_similarities, user, item)

print(f"\n–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ –¥–ª—è {user}:")
for item, rating in predicted_ratings_item_based.items():
    print(f"{item}: {rating:.2f}")

# –¢–µ–ø–µ—Ä—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–∏—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –º–æ–∂–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —ç–ª–µ–º–µ–Ω—Ç—ã —Å –Ω–∞–∏–≤—ã—Å—à–∏–º–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –æ—Ü–µ–Ω–∫–∞–º–∏.
<strong># –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ –¥–ª—è –ö–∞—Ç—è:
</strong># Item 2: 0.00
# Item 3: 1.00
# Item 6: 0.00
# Item 7: 0.00
# Item 9: 0.00

</code></pre>

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫–æ–ª–ª–∞–±–æ—Ä—Ç–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

* **–•–æ–ª–æ–¥–Ω—ã–π —Å—Ç–∞—Ä—Ç** - –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–æ–≤—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ç–æ–≤–∞—Ä–∞–º–∏ –∏–∑-–∑–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ –∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è—Ö. –≠—Ç–æ –∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.
* **Feedback loop** - —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—é –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞. –≠—Ç–æ –∑–∞–º—ã–∫–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º –∫—Ä—É–≥–µ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤.
* **Feature engine** - –º–µ—Ç–æ–¥—ã –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–≤–µ–¥–µ–Ω–∏–π –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –∏–ª–∏ —Ç–æ–≤–∞—Ä–∞—Ö. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å—Ç—Ä–æ—è—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π.

***

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º?

–ö–æ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —Å –º–∏–ª–ª–∏–æ–Ω–∞–º–∏ —Ç–æ–≤–∞—Ä–æ–≤, –∑–∞–¥–∞—á–∞ ‚Äî –≤—ã–±—Ä–∞—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü–æ—Å–∫–æ–ª—å–∫—É –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å, –ø—Ä–æ—Ü–µ—Å—Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞–∑–¥–µ–ª—è—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤. –≠—Ç–∏ —ç—Ç–∞–ø—ã –≤–∫–ª—é—á–∞—é—Ç —Ä–∞–±–æ—Ç—É —Å —Ä–∞–Ω–∂–∏—Ä—É—é—â–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏, –æ—Ç–±–æ—Ä–æ–º –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–º —Ä–µ—Ä–∞–Ω–∫–∏–Ω–≥–æ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.

<figure><img src="../../../.gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>

### **–ë–∞–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (Document Pool)**

<figure><img src="../../../.gitbook/assets/image (4).png" alt=""><figcaption></figcaption></figure>

–ü–µ—Ä–≤—ã–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –¥–æ—Å—Ç—É–ø –∫ –æ–≥—Ä–æ–º–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –í –±–∞–∑–µ –º–æ–≥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –º–∏–ª–ª–∏–æ–Ω—ã —Ç–æ–≤–∞—Ä–æ–≤, —Ñ–∏–ª—å–º–æ–≤, –º—É–∑—ã–∫–∏ –∏ –ø—Ä–æ—á–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞. –≠—Ç–æ –≤—Å—ë —Ç–æ, —á—Ç–æ –º–æ–∂–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π. –ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –æ–≥—Ä–æ–º–µ–Ω ‚Äî –ø–æ—Ä—è–¥–∫–∞ **10‚Åπ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤**.

### **–û—Ç–±–æ—Ä –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ (Candidate Generation)**

{% hint style="success" %}
–ß—Ç–æ–±—ã —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏ –±—ã—Å—Ç—Ä–æ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã, –Ω—É–∂–Ω–æ —Å—É–∑–∏—Ç—å –∫—Ä—É–≥ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤.&#x20;
{% endhint %}

–ù–∞ —ç—Ç–∞–ø–µ –æ—Ç–±–æ—Ä–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –∑–∞–¥–∞—á–∞ —Å–≤–æ–¥–∏—Ç—Å—è –∫ —É–º–µ–Ω—å—à–µ–Ω–∏—é —á–∏—Å–ª–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Å –º–∏–ª–ª–∏–æ–Ω–æ–≤ –¥–æ —Å–æ—Ç–µ–Ω. –í–µ–¥—å —É—á–∏—Ç—ã–≤–∞—Ç—å –≤—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å-—Ç–æ–≤–∞—Ä —ç—Ç–æ –æ–≥—Ä–æ–º–Ω–æ–µ —á–∏—Å–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ –∏ –Ω–µ –ø–æ–º–µ—Å—Ç–∏—Ç—Å—è –≤ –ø–∞–º—è—Ç—å –∏ –±—É–¥–µ—Ç –¥–æ–ª–≥–æ –≤—ã—á–∏—Å–ª—è—Ç—å—Å—è. –¢–∞–∫ –¥–∞–≤–∞–π—Ç–µ –≤–æ–∑—å–º–µ–º Top-K —Ç–æ–≤–∞—Ä–æ–≤!

–≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∏—Å—Ç–æ—Ä–∏—é –ø–æ–∫—É–ø–æ–∫ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤.

* **–ö–∞–Ω–¥–∏–¥–∞—Ç—ã** ‚Äî —ç—Ç–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (—Ç–æ–≤–∞—Ä—ã, —Ñ–∏–ª—å–º—ã –∏ —Ç.–¥.), –∫–æ—Ç–æ—Ä—ã–µ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.
* **–ü–æ–∑–∏—Ç–∏–≤—ã** ‚Äî —ç—Ç–æ —ç–ª–µ–º–µ–Ω—Ç—ã, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –≤ –ø—Ä–æ—à–ª–æ–º. –û–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏, —á—Ç–æ–±—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞—Ö–æ—Ç–µ—Ç—å –≤ –±—É–¥—É—â–µ–º.
* –ù–µ–≥–∞—Ç–∏–≤—ã - —ç—Ç–æ —ç–ª–µ–º–µ–Ω—Ç—ã, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Ö–æ—Ç–µ–ª –±—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –∏–ª–∏ —É–∂–µ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ –ø—Ä–æ–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª –∫–æ–≥–¥–∞-–ª–∏–±–æ. –û–Ω–∏ —Ç–∞–∫-–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è.

**–ú–µ—Ç–æ–¥—ã –æ—Ç–±–æ—Ä–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤**

{% hint style="info" %}
–ù–æ –∫–∞–∫ –Ω–∞–º –æ—Ç–æ–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤? –ï—Å—Ç—å –ª–∏ –∫–∞–∫–∏–µ-—Ç–æ —Å–ø–æ—Å–æ–±—ã –∫–∞–∫ –ø–æ–Ω—è—Ç—å —á—Ç–æ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–æ–≤–∞—Ä x –ª—É—á—à–µ —á–µ–º —Ç–æ–≤–∞—Ä y?
{% endhint %}

1. **–≠–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–¥—Ö–æ–¥—ã**: –°–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –∏–ª–∏ —Ç–æ–≤–∞—Ä—ã, –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å—Ä–µ–¥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –≥—Ä—É–ø–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
2. **–ö–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã**: –ú–µ—Ç–æ–¥—ã –≤—Ä–æ–¥–µ item2item –∏–ª–∏ user2user –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ—Ö–æ–∂–µ—Å—Ç–∏.
3. **–ö–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã**: –ü–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –±–ª–∏–∑–∫–∏—Ö –ø–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º. –î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–∞–∫–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö, –∫–∞–∫ HNSW –∏ FAISS.
4. **–£—á–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏**: –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –∏–ª–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è.

### **–†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ (Ranking)**

<figure><img src="../../../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

–ü–æ—Å–ª–µ –æ—Ç–±–æ—Ä–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏—Å–≤–æ–∏—Ç—å –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –æ—Ü–µ–Ω–∫—É —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–¥–µ–ª–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏–ª–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –û—Ü–µ–Ω–∏–≤–∞—é—Ç—Å—è —Ç–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã, –∫–∞–∫ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å, –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç.

**–î–ª—è —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å, –≤–∫–ª—é—á–∞—é—â–∞—è:**

* **–ö–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏**: –£ –∫–∞–∂–¥–æ–π –∏–∑ –Ω–∏—Ö —Å–≤–æ–∏ –ø–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã, –∏—Ö –º–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.
* **–ö–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**: –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –¥–Ω—è, –¥–Ω—è –Ω–µ–¥–µ–ª–∏ –∏ –¥—Ä—É–≥–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤.
* **–ü—Ä–∏–∑–Ω–∞–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤**: –í–∞–∂–Ω—ã —Ç–∞–∫–∏–µ –∞—Ç—Ä–∏–±—É—Ç—ã, –∫–∞–∫ –±—Ä–µ–Ω–¥, —Ü–µ–Ω–∞ –∏ –¥—Ä—É–≥–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç–æ–≤–∞—Ä–∞.

**–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —á–∞—â–µ –≤—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–∞–Ω–∂–∏—Ä—É—é—â–∏–µ –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –∫–æ–º–±–∏–Ω–∏—Ä—É—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:**

1. **–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π** (–∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–µ).
2. **–ü—Ä–∏–∑–Ω–∞–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**: –ü–æ–ª, –≤–æ–∑—Ä–∞—Å—Ç, –∏—Å—Ç–æ—Ä–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π.
3. **–ü—Ä–∏–∑–Ω–∞–∫–∏ –æ–±—ä–µ–∫—Ç–∞**: –¶–µ–Ω–∞, –≤–µ—Å, –∂–∞–Ω—Ä, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π.
4. **–ê–≥—Ä–µ–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**: –ó–∞ 7, 14, 30, n –¥–Ω–µ–π
5. **–û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**: user-item, user-category, user-segment
6. **–ö–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**: –î–µ–Ω—å –Ω–µ–¥–µ–ª–∏, –ø–æ–≥–æ–¥–∞, –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ.

**–ó–∞–¥–∞—á–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å:**

1. **–ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è**: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–ª–∏—á–∏—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.
2. **–†–µ–≥—Ä–µ—Å—Å–∏—è**: –ü—Ä–∏–º–µ—Ä ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–∏–¥–µ–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
3. **–†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–æ–¥—Ö–æ–¥—ã pairwise –∏ listwise –ø–æ–º–æ–≥–∞—é—Ç –º–æ–¥–µ–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### **–†–µ—Ä–∞–Ω–∫–∏–Ω–≥ (Re-ranking)**

–†–µ—Ä–∞–Ω–∫–∏–Ω–≥ ‚Äî —ç—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —à–∞–≥ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —á–∞—Å—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—á–∏—Ç—ã–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –±–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–∞—Ä—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –∏–ª–∏ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –≤ —Å–ø–∏—Å–∫–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.

* –ü–æ—Å–ª–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç—ã –ø–µ—Ä–µ—Å–æ—Ä—Ç–∏—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è —Å —É—á—ë—Ç–æ–º —Ç–∞–∫–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤, –∫–∞–∫ —Ü–µ–Ω–∞, –Ω–∞–ª–∏—á–∏–µ —Ç–æ–≤–∞—Ä–∞, –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ –¥—Ä—É–≥–∏–µ –∞—Ç—Ä–∏–±—É—Ç—ã.
* –†–µ—Ä–∞–Ω–∫–∏–Ω–≥ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫ –∏–∑–º–µ–Ω—è—é—â–∏–º—Å—è —É—Å–ª–æ–≤–∏—è–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

### **–§–∏–Ω–∞–ª—å–Ω–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**

–ü–æ—Å–ª–µ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ –Ω–µ–±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —ç—Ç–æ **–¥–µ—Å—è—Ç–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤**, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ç–µ–º –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

***

## –ú–∞—Ç—Ä–∏—á–Ω–∞—è —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### SVD



### ALS

**Alternative Least Squares (ALS)** ‚Äî —ç—Ç–æ –º–µ—Ç–æ–¥ –º–∞—Ç—Ä–∏—á–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–∞—Å—Ç–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–µ–±–µ, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –æ–≥—Ä–æ–º–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ (—Ç–∞–±–ª–∏—Ü–∞) —Å –æ—Ü–µ–Ω–∫–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –≤ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º —Å–µ—Ä–≤–∏—Å–µ. –¢–∞–∫ –≤–æ—Ç ALS –ø–æ–º–æ–≥–∞–µ—Ç —Ä–∞–∑–±–∏—Ç—å –Ω–∞—à—É –º–∞—Ç—Ä–∏—Ü—É –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã.

***

## –ö–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è

### user KNN

### item KNN

### TF-IDF iKNN

### TIFU

***

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

{% embed url="http://yifanhu.net/PUB/cf.pdf" %}

{% embed url="https://youtu.be/hW1NvSBS9LU?si=l_fQP0JMgTJcUVvI" %}

{% embed url="https://www.youtube.com/watch?v=v8KoaPvCEqU&list=PLJR10EXrBaAssiryiUzD4dFCdIVwDGi02&index=3" %}

{% embed url="https://youtu.be/vL4fCP3LVdg?si=XgNvEDUqxQKaITkj" %}

{% embed url="https://www.youtube.com/watch?v=GC0K27AZ_Pg" %}

{% embed url="https://www.youtube.com/watch?v=O5989w5uD98" %}

{% embed url="https://d2l.ai/chapter_recommender-systems/mf.html" %}

{% embed url="https://rectools.readthedocs.io/en/stable/api/rectools.models.implicit_als.ImplicitALSWrapperModel.htm" %}
